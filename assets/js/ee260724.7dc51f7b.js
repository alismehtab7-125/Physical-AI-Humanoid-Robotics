"use strict";(globalThis.webpackChunkmy_website=globalThis.webpackChunkmy_website||[]).push([[292],{651:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"module-01/python-ros-integration","title":"Writing ROS 2 Nodes in Python (rclpy)","description":"Introduction to rclpy","source":"@site/docs/module-01/04-python-ros-integration.md","sourceDirName":"module-01","slug":"/module-01/python-ros-integration","permalink":"/Physical-AI-Humanoid-Robotics/docs/module-01/python-ros-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/alismehtab7-125/Physical-AI-Humanoid-Robotics/edit/main/docs/module-01/04-python-ros-integration.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Writing ROS 2 Nodes in Python (rclpy)"},"sidebar":"tutorialSidebar","previous":{"title":"Setting Up Workspace and Packages","permalink":"/Physical-AI-Humanoid-Robotics/docs/module-01/workspace-and-packages"},"next":{"title":"Launch Files and Parameter Management","permalink":"/Physical-AI-Humanoid-Robotics/docs/module-01/launch-files-and-params"}}');var r=s(4848),o=s(8453);const l={sidebar_position:4,title:"Writing ROS 2 Nodes in Python (rclpy)"},t="Writing ROS 2 Nodes in Python (rclpy)",a={},d=[{value:"Introduction to rclpy",id:"introduction-to-rclpy",level:2},{value:"Setting Up Your Python Environment",id:"setting-up-your-python-environment",level:2},{value:"Basic Node Structure",id:"basic-node-structure",level:2},{value:"Creating a Publisher Node",id:"creating-a-publisher-node",level:2},{value:"Key Components of a Publisher Node:",id:"key-components-of-a-publisher-node",level:3},{value:"Creating a Subscriber Node",id:"creating-a-subscriber-node",level:2},{value:"Key Components of a Subscriber Node:",id:"key-components-of-a-subscriber-node",level:3},{value:"Running Publisher and Subscriber Nodes",id:"running-publisher-and-subscriber-nodes",level:2},{value:"Method 1: Using ros2 run",id:"method-1-using-ros2-run",level:3},{value:"Method 2: Direct Python Execution",id:"method-2-direct-python-execution",level:3},{value:"Advanced Publisher Features",id:"advanced-publisher-features",level:2},{value:"Publishing Different Message Types",id:"publishing-different-message-types",level:3},{value:"Best Practices for Python ROS 2 Nodes",id:"best-practices-for-python-ros-2-nodes",level:2},{value:"1. Error Handling",id:"1-error-handling",level:3},{value:"2. Logging",id:"2-logging",level:3},{value:"3. Proper Node Destruction",id:"3-proper-node-destruction",level:3},{value:"Common Message Types",id:"common-message-types",level:2},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"writing-ros-2-nodes-in-python-rclpy",children:"Writing ROS 2 Nodes in Python (rclpy)"})}),"\n",(0,r.jsx)(n.h2,{id:"introduction-to-rclpy",children:"Introduction to rclpy"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"rclpy"})," is the Python client library for ROS 2. It provides a Python API that allows you to create ROS 2 nodes, publish and subscribe to topics, provide and use services, and manage parameters. This library is the Python equivalent of ",(0,r.jsx)(n.code,{children:"rclcpp"})," for C++."]}),"\n",(0,r.jsx)(n.h2,{id:"setting-up-your-python-environment",children:"Setting Up Your Python Environment"}),"\n",(0,r.jsx)(n.p,{children:"Before creating ROS 2 nodes in Python, ensure your environment is properly configured:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Source your ROS 2 installation\nsource /opt/ros/humble/setup.bash  # Replace 'humble' with your ROS 2 distribution\n\n# Create a workspace (if you haven't already)\nmkdir -p ~/ros2_ws/src\ncd ~/ros2_ws\n\n# Source your workspace (if you have one)\nsource install/setup.bash\n"})}),"\n",(0,r.jsx)(n.h2,{id:"basic-node-structure",children:"Basic Node Structure"}),"\n",(0,r.jsx)(n.p,{children:"Every ROS 2 Python node follows the same basic structure:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\nclass MyNode(Node):\n    def __init__(self):\n        super().__init__('node_name')\n        # Node initialization code here\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = MyNode()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-publisher-node",children:"Creating a Publisher Node"}),"\n",(0,r.jsx)(n.p,{children:"A publisher node sends messages to a topic. Here's a complete example of a publisher node that publishes string messages:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalPublisher(Node):\n    def __init__(self):\n        super().__init__('minimal_publisher')\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello World: {self.i}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_publisher = MinimalPublisher()\n\n    rclpy.spin(minimal_publisher)\n\n    # Destroy the node explicitly\n    minimal_publisher.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"key-components-of-a-publisher-node",children:"Key Components of a Publisher Node:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Import Statements"}),": Import ",(0,r.jsx)(n.code,{children:"rclpy"}),", the ",(0,r.jsx)(n.code,{children:"Node"})," class, and the message type (",(0,r.jsx)(n.code,{children:"std_msgs.msg.String"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node Class"}),": Inherit from ",(0,r.jsx)(n.code,{children:"Node"})," and initialize with a unique node name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publisher Creation"}),": Use ",(0,r.jsx)(n.code,{children:"create_publisher()"})," to create a publisher for a specific topic and message type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Timer"}),": Use a timer to periodically publish messages"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Message Creation"}),": Create and populate message objects with data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Publish"}),": Call ",(0,r.jsx)(n.code,{children:"publish()"})," to send the message to the topic"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"creating-a-subscriber-node",children:"Creating a Subscriber Node"}),"\n",(0,r.jsx)(n.p,{children:"A subscriber node receives messages from a topic. Here's a complete example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"#!/usr/bin/env python3\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\n\nclass MinimalSubscriber(Node):\n    def __init__(self):\n        super().__init__('minimal_subscriber')\n        self.subscription = self.create_subscription(\n            String,\n            'topic',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    minimal_subscriber = MinimalSubscriber()\n\n    rclpy.spin(minimal_subscriber)\n\n    # Destroy the node explicitly\n    minimal_subscriber.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"key-components-of-a-subscriber-node",children:"Key Components of a Subscriber Node:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Import Statements"}),": Import ",(0,r.jsx)(n.code,{children:"rclpy"}),", the ",(0,r.jsx)(n.code,{children:"Node"})," class, and the message type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node Class"}),": Inherit from ",(0,r.jsx)(n.code,{children:"Node"})," and initialize with a unique node name"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Subscription Creation"}),": Use ",(0,r.jsx)(n.code,{children:"create_subscription()"})," to subscribe to a topic with a callback function"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Callback Function"}),": Define a function that will be called when a message is received"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Message Processing"}),": Process the received message in the callback"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"running-publisher-and-subscriber-nodes",children:"Running Publisher and Subscriber Nodes"}),"\n",(0,r.jsx)(n.h3,{id:"method-1-using-ros2-run",children:"Method 1: Using ros2 run"}),"\n",(0,r.jsx)(n.p,{children:"First, make sure your Python file is executable:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x my_package/my_publisher.py\nchmod +x my_package/my_subscriber.py\n"})}),"\n",(0,r.jsx)(n.p,{children:"Then run each node in separate terminals:"}),"\n",(0,r.jsx)(n.p,{children:"Terminal 1 (Publisher):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 run my_package my_publisher\n"})}),"\n",(0,r.jsx)(n.p,{children:"Terminal 2 (Subscriber):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"ros2 run my_package my_subscriber\n"})}),"\n",(0,r.jsx)(n.h3,{id:"method-2-direct-python-execution",children:"Method 2: Direct Python Execution"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 my_publisher.py\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"python3 my_subscriber.py\n"})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-publisher-features",children:"Advanced Publisher Features"}),"\n",(0,r.jsx)(n.h3,{id:"publishing-different-message-types",children:"Publishing Different Message Types"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Int32, Float32\nfrom geometry_msgs.msg import Twist\n\n\nclass AdvancedPublisher(Node):\n    def __init__(self):\n        super().__init__('advanced_publisher')\n\n        # Multiple publishers for different topics\n        self.int_publisher = self.create_publisher(Int32, 'integer_topic', 10)\n        self.float_publisher = self.create_publisher(Float32, 'float_topic', 10)\n        self.cmd_vel_publisher = self.create_publisher(Twist, 'cmd_vel', 10)\n\n        self.timer = self.create_timer(1.0, self.publish_messages)\n        self.counter = 0\n\n    def publish_messages(self):\n        # Publish integer\n        int_msg = Int32()\n        int_msg.data = self.counter\n        self.int_publisher.publish(int_msg)\n\n        # Publish float\n        float_msg = Float32()\n        float_msg.data = float(self.counter) * 0.5\n        self.float_publisher.publish(float_msg)\n\n        # Publish Twist (velocity command)\n        twist_msg = Twist()\n        twist_msg.linear.x = 1.0  # Move forward\n        twist_msg.angular.z = 0.5  # Rotate\n        self.cmd_vel_publisher.publish(twist_msg)\n\n        self.get_logger().info(f'Published: {self.counter}, {float(self.counter) * 0.5}')\n        self.counter += 1\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n    node = AdvancedPublisher()\n    rclpy.spin(node)\n    node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"best-practices-for-python-ros-2-nodes",children:"Best Practices for Python ROS 2 Nodes"}),"\n",(0,r.jsx)(n.h3,{id:"1-error-handling",children:"1. Error Handling"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def main(args=None):\n    try:\n        rclpy.init(args=args)\n        node = MyNode()\n        rclpy.spin(node)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        node.destroy_node()\n        rclpy.shutdown()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-logging",children:"2. Logging"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Use the built-in logger\nself.get_logger().info('Information message')\nself.get_logger().warn('Warning message')\nself.get_logger().error('Error message')\nself.get_logger().debug('Debug message')\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-proper-node-destruction",children:"3. Proper Node Destruction"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"def destroy_node(self):\n    # Clean up resources before destroying the node\n    # Cancel timers, destroy publishers/subscribers, etc.\n    super().destroy_node()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"common-message-types",children:"Common Message Types"}),"\n",(0,r.jsx)(n.p,{children:"Here are some commonly used message types in ROS 2:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"std_msgs.msg.String"})," - For string data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"std_msgs.msg.Int32"}),", ",(0,r.jsx)(n.code,{children:"std_msgs.msg.Float32"})," - For numeric data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sensor_msgs.msg.Image"})," - For image data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"geometry_msgs.msg.Twist"})," - For velocity commands"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"geometry_msgs.msg.Pose"})," - For position and orientation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"nav_msgs.msg.Odometry"})," - For odometry data"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Node not found"}),": Ensure the package is built and sourced"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Import errors"}),": Check that the message types are properly imported"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Topic not connecting"}),": Verify topic names match between publisher and subscriber"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Permission errors"}),": Make sure your Python files have execute permissions"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"With these examples and concepts, you can now create your own ROS 2 nodes in Python using the rclpy library!"})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var i=s(6540);const r={},o=i.createContext(r);function l(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);